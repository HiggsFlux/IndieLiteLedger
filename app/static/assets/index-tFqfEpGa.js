import{d as R,r as p,ap as W,N as V,b as g,o as u,f as i,e,w as l,c as k,a6 as A,E as D,g as v,_ as Y,as as j,J as M,G as w,t as a,a9 as B,ae as N}from"./index-CcZaxT8H.js";import{u as C,g as O}from"./echarts-DBdiYHwB.js";const $={class:"p-4 space-y-4 bg-[#F0F2F5] min-h-screen text-[#333]"},z={class:"flex flex-wrap justify-between items-center gap-4"},T={class:"flex items-center gap-4"},I={class:"flex items-center gap-2"},P={class:"flex gap-2"},G={class:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4"},H={class:"metric-card bg-gradient-to-r from-[#3B82F6] to-[#60A5FA]"},U={class:"card-content"},J={class:"flex justify-between items-start"},q={class:"flex flex-col"},K={class:"metric-value"},Q={key:0,class:"mt-4 flex items-center text-xs text-white/80"},X={class:"metric-card bg-gradient-to-r from-[#F97316] to-[#FB923C]"},Z={class:"card-content"},ee={class:"flex justify-between items-start"},te={class:"flex flex-col"},se={class:"metric-value"},oe={key:0,class:"mt-4 flex items-center text-xs text-white/80"},ae={class:"metric-card bg-gradient-to-r from-[#8B5CF6] to-[#A78BFA]"},le={class:"card-content"},re={class:"flex justify-between items-start"},ie={class:"flex flex-col"},ne={class:"metric-value"},de={key:0,class:"mt-4 flex items-center text-xs text-white/80"},ce={class:"metric-card bg-gradient-to-r from-[#EF4444] to-[#F87171]"},ue={class:"card-content"},me={class:"flex justify-between items-start"},pe={class:"flex flex-col"},fe={class:"metric-value"},xe={class:"mt-4 flex items-center text-xs text-white/80"},_e={class:"metric-card bg-gradient-to-r from-[#06B6D4] to-[#22D3EE]"},ge={class:"card-content"},ve={class:"flex justify-between items-start"},he={class:"flex flex-col"},ye={class:"metric-value"},be={class:"mt-4 flex items-center text-xs text-white/80"},we={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Be=R({name:"dashboard_workbench",__name:"index",setup(Se){const r=p("year"),f=p(new Date().getFullYear().toString()),x=p(["2025-01","2025-12"]),s=p({total_income:0,income_growth:0,total_expense:0,expense_growth:0,new_customers:0,new_customers_growth:0,deal_customers:0,deal_customers_conversion_rate:0,total_profit:0,profit_margin:0}),_=p([]);async function h(){const d=x.value||[],{data:t}=await O({time_dimension:r.value,year:f.value,month_range:d.length===2?d:void 0});t&&(s.value=t.summary,S&&S(o=>(o.xAxis.data=t.trend_xAxis,o.series[0].data=t.trend_income,o.series[1].data=t.trend_expense,o.series[2].data=t.trend_profit,o.series[3].data=t.trend_margin,o)),_.value=t.expense_pie.map((o,c)=>({...o,itemStyle:{color:["#2dd4bf","#60a5fa","#818cf8","#fcd34d","#f472b6","#34d399"][c%6]}})),F&&F(o=>(o.series[0].data=_.value,o)))}W([r,f,x],()=>{h()}),V(()=>{h()});const{domRef:E,updateOptions:S}=C(()=>({tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"rgba(255, 255, 255, 0.95)",borderWidth:0,textStyle:{color:"#333"},shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.1)"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},legend:{data:["总收入","总支出","总利润","利润率"],top:0,itemWidth:10,itemHeight:10,textStyle:{color:"#666"}},xAxis:{type:"category",data:[],axisLine:{lineStyle:{color:"#E5E7EB"}},axisLabel:{color:"#6B7280"}},yAxis:[{type:"value",name:"金额 (元)",nameTextStyle:{color:"#6B7280"},axisLabel:{color:"#6B7280"},splitLine:{lineStyle:{type:"dashed",color:"#F3F4F6"}}},{type:"value",name:"利润率",nameTextStyle:{color:"#6B7280"},axisLabel:{color:"#6B7280",formatter:"{value} %"},splitLine:{show:!1}}],series:[{name:"总收入",type:"bar",barWidth:"20%",itemStyle:{borderRadius:[4,4,0,0],color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#2dd4bf"},{offset:1,color:"rgba(45, 212, 191, 0.2)"}]}},data:[]},{name:"总支出",type:"bar",barWidth:"20%",itemStyle:{borderRadius:[4,4,0,0],color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#818cf8"},{offset:1,color:"rgba(129, 140, 248, 0.2)"}]}},data:[]},{name:"总利润",type:"bar",barWidth:"20%",itemStyle:{borderRadius:[4,4,0,0],color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#60a5fa"},{offset:1,color:"rgba(96, 165, 250, 0.2)"}]}},data:[]},{name:"利润率",type:"line",yAxisIndex:1,smooth:!0,symbol:"circle",symbolSize:8,lineStyle:{width:3,color:"#fcd34d"},itemStyle:{color:"#fcd34d",borderColor:"#fff",borderWidth:2},data:[]}]})),{domRef:L,updateOptions:F}=C(()=>({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{bottom:"0%",left:"center",itemWidth:10,itemHeight:10,textStyle:{color:"#666"},formatter:d=>{const t=_.value.find(n=>n.name===d),o=_.value.reduce((n,y)=>n+y.value,0),c=t&&o>0?(t.value/o*100).toFixed(1)+"%":"0%";return`${d}  ${c}`}},series:[{name:"支出构成",type:"pie",radius:["45%","70%"],center:["50%","50%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:8,borderColor:"#fff",borderWidth:3},label:{show:!1},data:[]}]}));return(d,t)=>{const o=A,c=Y,n=D,y=j,b=M;return u(),g("div",$,[i(b,{shadow:"never",class:"!border-none !bg-white rounded-lg shadow-sm","body-style":{padding:"16px"}},{default:l(()=>[e("div",z,[e("div",T,[t[6]||(t[6]=e("div",{class:"font-bold text-lg border-l-4 border-[#3B82F6] pl-3 text-gray-800"},"工作台概览",-1)),e("div",I,[r.value==="year"?(u(),k(o,{key:0,modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=m=>f.value=m),type:"year",placeholder:"年份",size:"default",style:{width:"100px"},"value-format":"YYYY",clearable:!1},null,8,["modelValue"])):(u(),k(o,{key:1,modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=m=>x.value=m),type:"monthrange","range-separator":"-","start-placeholder":"开始","end-placeholder":"结束",size:"default",style:{width:"200px"},"value-format":"YYYY-MM",clearable:!1},null,8,["modelValue"])),e("div",P,[i(n,{type:"primary",class:"!bg-[#3B82F6] !border-[#3B82F6] hover:!bg-[#2563EB]",onClick:h},{icon:l(()=>[i(c,{icon:"mdi:magnify",class:"text-lg"})]),default:l(()=>[t[4]||(t[4]=v(" 查询 ",-1))]),_:1}),i(n,{class:"!text-[#666] hover:!text-[#3B82F6] hover:!border-[#3B82F6]"},{icon:l(()=>[i(c,{icon:"mdi:refresh",class:"text-lg"})]),default:l(()=>[t[5]||(t[5]=v(" 重置 ",-1))]),_:1})])])]),i(y,null,{default:l(()=>[i(n,{type:r.value==="month"?"primary":"default",onClick:t[2]||(t[2]=m=>r.value="month"),class:"!h-8"},{default:l(()=>[...t[7]||(t[7]=[v("月",-1)])]),_:1},8,["type"]),i(n,{type:r.value==="year"?"primary":"default",onClick:t[3]||(t[3]=m=>r.value="year"),class:"!h-8"},{default:l(()=>[...t[8]||(t[8]=[v("年",-1)])]),_:1},8,["type"])]),_:1})])]),_:1}),e("div",G,[e("div",H,[e("div",U,[e("div",J,[e("div",q,[t[9]||(t[9]=e("span",{class:"metric-label"},"总收入 (元)",-1)),e("span",K,a(Math.round(s.value.total_income).toLocaleString()),1)]),t[10]||(t[10]=e("div",{class:"i-mdi-currency-usd text-3xl text-white/30 p-2 bg-white/10 rounded-lg"},null,-1))]),r.value==="year"?(u(),g("div",Q,[e("span",null,"较上期 "+a(s.value.income_growth>=0?"+":"")+a(s.value.income_growth)+"%",1),e("div",{class:B([s.value.income_growth>=0?"i-mdi-trending-up":"i-mdi-trending-down","ml-1"])},null,2)])):w("",!0)])]),e("div",X,[e("div",Z,[e("div",ee,[e("div",te,[t[11]||(t[11]=e("span",{class:"metric-label"},"总支出 (元)",-1)),e("span",se,a(Math.round(s.value.total_expense).toLocaleString()),1)]),t[12]||(t[12]=e("div",{class:"i-mdi-cash-minus text-3xl text-white/30 p-2 bg-white/10 rounded-lg"},null,-1))]),r.value==="year"?(u(),g("div",oe,[e("span",null,"较上期 "+a(s.value.expense_growth>=0?"+":"")+a(s.value.expense_growth)+"%",1),e("div",{class:B([s.value.expense_growth>=0?"i-mdi-trending-up":"i-mdi-trending-down","ml-1"])},null,2)])):w("",!0)])]),e("div",ae,[e("div",le,[e("div",re,[e("div",ie,[t[13]||(t[13]=e("span",{class:"metric-label"},"新客户总数 (位)",-1)),e("span",ne,a(s.value.new_customers),1)]),t[14]||(t[14]=e("div",{class:"i-mdi-account-plus text-3xl text-white/30 p-2 bg-white/10 rounded-lg"},null,-1))]),r.value==="year"?(u(),g("div",de,[e("span",null,"较上期 "+a(s.value.new_customers_growth>=0?"+":"")+a(s.value.new_customers_growth)+"%",1),e("div",{class:B([s.value.new_customers_growth>=0?"i-mdi-trending-up":"i-mdi-trending-down","ml-1"])},null,2)])):w("",!0)])]),e("div",ce,[e("div",ue,[e("div",me,[e("div",pe,[t[15]||(t[15]=e("span",{class:"metric-label"},"成交客户总数 (位)",-1)),e("span",fe,a(s.value.deal_customers),1)]),t[16]||(t[16]=e("div",{class:"i-mdi-handshake text-3xl text-white/30 p-2 bg-white/10 rounded-lg"},null,-1))]),e("div",xe,[e("span",null,"转化率 "+a(s.value.deal_customers_conversion_rate)+"%",1)])])]),e("div",_e,[e("div",ge,[e("div",ve,[e("div",he,[t[17]||(t[17]=e("span",{class:"metric-label"},"总利润 (元)",-1)),e("span",ye,a(Math.round(s.value.total_profit).toLocaleString()),1)]),t[18]||(t[18]=e("div",{class:"i-mdi-chart-line text-3xl text-white/30 p-2 bg-white/10 rounded-lg"},null,-1))]),e("div",be,[e("span",null,"利润率 "+a(s.value.profit_margin)+"%",1)])])])]),e("div",we,[i(b,{class:"lg:col-span-2 !border-none shadow-sm rounded-lg","body-style":{padding:"20px"}},{header:l(()=>[...t[19]||(t[19]=[e("div",{class:"flex justify-between items-center"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-1 h-4 bg-[#3B82F6] rounded-sm"}),e("span",{class:"font-bold text-gray-800"},"收支盈亏趋势")]),e("span",{class:"text-xs text-gray-500"},"利润率为销售利润率")],-1)])]),default:l(()=>[e("div",{ref_key:"trendChartRef",ref:E,class:"w-full h-[380px]"},null,512)]),_:1}),i(b,{class:"shadow-sm rounded-lg","body-style":{padding:"20px"}},{header:l(()=>[...t[20]||(t[20]=[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-1 h-4 bg-[#10B981] rounded-sm"}),e("span",{class:"font-bold text-gray-800"},"支出构成")],-1)])]),default:l(()=>[e("div",{ref_key:"expenseChartRef",ref:L,class:"w-full h-[380px]"},null,512)]),_:1})])])}}}),Ce=N(Be,[["__scopeId","data-v-1e3c4e0e"]]);export{Ce as default};
