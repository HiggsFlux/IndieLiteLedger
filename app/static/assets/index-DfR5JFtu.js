import{d as O,af as q,r as d,ag as H,N as J,b as z,o as m,f as t,w as n,y as W,p as X,q as G,x as S,ah as Q,W as Z,X as ee,ai as te,E as ae,g as s,J as le,e as V,O as ne,c as x,aj as oe,ak as se,R as ie,t as P,P as re,al as ue,am as de,ad as pe,ac as fe,ae as me}from"./index-CcZaxT8H.js";import{b as ce,d as _e}from"./client-BNDKmuV7.js";import{_ as ve}from"./ClientOperateDialog.vue_vue_type_script_setup_true_lang-DimCu2l5.js";const ge={class:"h-full overflow-hidden flex flex-col p-4 gap-4"},ye={class:"mb-4"},be={class:"mt-4 flex justify-end"},we=O({name:"customer_list",__name:"index",setup(he){const D=q(),g=d(!1),c=d([]),i=d({name:"",phone:"",status:void 0}),y=d("add"),_=d(!1);d(!1);const b=d(null),w={0:{label:"线索/询单",type:"info"},1:{label:"试用/POC",type:"primary"},2:{label:"正式成交",type:"success"},3:{label:"流失/过期",type:"warning"},9:{label:"黑名单",type:"danger"}},o=H({currentPage:1,pageSize:20,total:0});async function u(){g.value=!0;try{const{data:l}=await ce({...i.value,skip:(o.currentPage-1)*o.pageSize,limit:o.pageSize});l&&(Array.isArray(l)?(c.value=l,o.total=l.length):l.items?(c.value=l.items,o.total=l.total||l.items.length):c.value=l)}finally{g.value=!1}}function B(l){o.pageSize=l,u()}function M(l){o.currentPage=l,u()}function h(){o.currentPage=1,u()}function U(){i.value={name:"",phone:"",status:void 0},o.currentPage=1,u()}function N(){y.value="add",b.value=null,_.value=!0}function T(l){y.value="edit",b.value=l,_.value=!0}function $(l){D.push({path:`/customer/detail/${l.id}`})}async function j(l){try{await de.confirm("确认删除该客户吗？","提示",{type:"warning"}),await _e(l.id),pe.success("删除成功"),u()}catch{}}function L(l){return l?fe(l).format("YYYY-MM-DD HH:mm"):"-"}return J(()=>{u()}),(l,e)=>{const k=G,v=X,R=te,Y=Q,p=ae,A=W,E=le,r=se,C=ie,F=oe,I=ue,K=re;return m(),z("div",ge,[t(E,{shadow:"never",class:"flex-none"},{default:n(()=>[t(A,{inline:!0,model:i.value},{default:n(()=>[t(v,{label:"客户名称"},{default:n(()=>[t(k,{modelValue:i.value.name,"onUpdate:modelValue":e[0]||(e[0]=a=>i.value.name=a),placeholder:"请输入客户名称",clearable:"",onKeyup:S(h,["enter"])},null,8,["modelValue"])]),_:1}),t(v,{label:"手机号"},{default:n(()=>[t(k,{modelValue:i.value.phone,"onUpdate:modelValue":e[1]||(e[1]=a=>i.value.phone=a),placeholder:"请输入手机号",clearable:"",onKeyup:S(h,["enter"])},null,8,["modelValue"])]),_:1}),t(v,{label:"状态"},{default:n(()=>[t(Y,{modelValue:i.value.status,"onUpdate:modelValue":e[2]||(e[2]=a=>i.value.status=a),placeholder:"请选择状态",clearable:"",style:{width:"150px"}},{default:n(()=>[(m(),z(Z,null,ee(w,(a,f)=>t(R,{key:f,label:a.label,value:Number(f)},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:n(()=>[t(p,{type:"primary",onClick:h},{default:n(()=>[...e[6]||(e[6]=[s("搜索",-1)])]),_:1}),t(p,{onClick:U},{default:n(()=>[...e[7]||(e[7]=[s("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(E,{shadow:"never",class:"flex-1 flex flex-col min-h-0"},{default:n(()=>[V("div",ye,[t(p,{type:"primary",onClick:N},{default:n(()=>[...e[8]||(e[8]=[s("新增客户",-1)])]),_:1})]),ne((m(),x(F,{data:c.value,border:"",style:{width:"100%",height:"100%"}},{default:n(()=>[t(r,{prop:"name",label:"客户名称","min-width":"150","show-overflow-tooltip":""}),t(r,{prop:"type",label:"类型",width:"100"},{default:n(({row:a})=>[a.type===0?(m(),x(C,{key:0,type:"info"},{default:n(()=>[...e[9]||(e[9]=[s("个人",-1)])]),_:1})):(m(),x(C,{key:1,type:"primary"},{default:n(()=>[...e[10]||(e[10]=[s("企业",-1)])]),_:1}))]),_:1}),t(r,{prop:"status",label:"状态",width:"120"},{default:n(({row:a})=>[t(C,{type:w[a.status]?.type},{default:n(()=>[s(P(w[a.status]?.label),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"wechat",label:"微信号",width:"150","show-overflow-tooltip":""}),t(r,{prop:"phone",label:"手机号",width:"150","show-overflow-tooltip":""}),t(r,{prop:"contact_person",label:"联系人",width:"120","show-overflow-tooltip":""}),t(r,{prop:"created_at",label:"创建时间",width:"180"},{default:n(({row:a})=>[s(P(L(a.created_at)),1)]),_:1}),t(r,{label:"操作",width:"250",fixed:"right"},{default:n(({row:a})=>[t(p,{link:"",type:"primary",onClick:f=>$(a)},{default:n(()=>[...e[11]||(e[11]=[s("详情",-1)])]),_:2},1032,["onClick"]),t(p,{link:"",type:"primary",onClick:f=>T(a)},{default:n(()=>[...e[12]||(e[12]=[s("编辑",-1)])]),_:2},1032,["onClick"]),t(p,{link:"",type:"danger",onClick:f=>j(a)},{default:n(()=>[...e[13]||(e[13]=[s("删除",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,g.value]]),V("div",be,[t(I,{"current-page":o.currentPage,"onUpdate:currentPage":e[3]||(e[3]=a=>o.currentPage=a),"page-size":o.pageSize,"onUpdate:pageSize":e[4]||(e[4]=a=>o.pageSize=a),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:o.total,onSizeChange:B,onCurrentChange:M},null,8,["current-page","page-size","total"])])]),_:1}),t(ve,{visible:_.value,"onUpdate:visible":e[5]||(e[5]=a=>_.value=a),"operate-type":y.value,"row-data":b.value,onSubmitted:u},null,8,["visible","operate-type","row-data"])])}}}),Ee=me(we,[["__scopeId","data-v-80aef1f9"]]);export{Ee as default};
