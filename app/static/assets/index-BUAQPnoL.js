import{d as V,r as f,a as B,b as c,o as m,e as l,t as v,f as o,G as C,aN as N,aB as $,w as n,E as w,g as k,ad as b,ag as F,N as L,O as T,y as q,p as I,q as O,az as D,P as M,J as G,aO as P,aP as z,B as J}from"./index-CN2tD0BG.js";import{b as A}from"./order-Cf5wmHeH.js";const H={class:"flex items-start gap-4"},K={class:"w-32 h-32 border border-gray-200 rounded-lg flex items-center justify-center overflow-hidden bg-gray-50 shrink-0"},Q=["src"],R={key:1,class:"text-gray-400 text-sm"},W={class:"flex flex-col gap-2 pt-1"},X={key:0,class:"text-xs text-gray-400 leading-relaxed"},h=V({name:"ImageUpload",__name:"image-upload",props:{modelValue:{},placeholder:{default:"上传图片"},accept:{default:".jpg,.jpeg,.png,.gif,.ico,.svg"},tip:{},emptyText:{default:"暂无图片"}},emits:["update:modelValue"],setup(x,{emit:p}){const d=x,s=p,r=f(!1),u=B({get(){return d.modelValue},set(t){s("update:modelValue",t||"")}});async function g(t){const{file:e}=t;r.value=!0;try{const{data:a}=await A(e);a&&a.url&&(u.value=a.url,b.success("上传成功"))}catch{b.error("上传失败")}finally{r.value=!1}}return(t,e)=>{const a=w,y=$;return m(),c("div",H,[l("div",K,[u.value?(m(),c("img",{key:0,src:u.value,class:"w-full h-full object-contain"},null,8,Q)):(m(),c("span",R,v(t.emptyText),1))]),l("div",W,[o(y,{action:"","http-request":g,"show-file-list":!1,disabled:r.value,accept:d.accept},{default:n(()=>[o(a,{type:"primary",loading:r.value},{default:n(()=>[k(v(t.placeholder),1)]),_:1},8,["loading"])]),_:1},8,["disabled","accept"]),t.tip?(m(),c("div",X,v(t.tip),1)):C("",!0),N(t.$slots,"tip")])])}}}),Y={class:"h-full overflow-hidden p-4"},Z={class:"flex justify-between items-center"},ee={class:"flex-1 overflow-auto p-4"},te={class:"mb-6"},se={class:"mb-6"},le=V({name:"system_sys-config",__name:"index",setup(x){const p=f(!1),d=f(!1);f("basic");const s=F({"system.app_name":"","system.logo":"","system.favicon":"","security.session_timeout":30}),r=f([]);async function u(){p.value=!0;try{const t=await P();t.data&&(r.value=t.data,t.data.forEach(e=>{Object.keys(s).includes(e.config_key)&&(e.config_key==="security.session_timeout"?s[e.config_key]=Number(e.config_value)||30:s[e.config_key]=e.config_value||"")}))}catch(t){console.error(t)}finally{p.value=!1}}async function g(){d.value=!0;try{const t={};Object.keys(s).forEach(a=>{t[a]=String(s[a])}),await z(t),b.success("配置已保存"),await J().initThemeFromBackend(),u()}catch(t){console.error(t)}finally{d.value=!1}}return L(()=>{u()}),(t,e)=>{const a=w,y=O,_=I,E=D,S=q,U=G,j=M;return m(),c("div",Y,[o(U,{shadow:"never",class:"h-full flex flex-col border-none"},{header:n(()=>[l("div",Z,[e[5]||(e[5]=l("span",{class:"font-bold text-lg"},"系统基础配置",-1)),o(a,{type:"primary",loading:d.value,onClick:g},{default:n(()=>[...e[4]||(e[4]=[k("保存配置",-1)])]),_:1},8,["loading"])])]),default:n(()=>[T((m(),c("div",ee,[o(S,{"label-position":"top",class:"max-w-2xl"},{default:n(()=>[l("div",te,[e[7]||(e[7]=l("h3",{class:"text-base font-medium mb-4 pb-2 border-b"},"基本设置",-1)),o(_,{label:"系统名称",required:""},{default:n(()=>[o(y,{modelValue:s["system.app_name"],"onUpdate:modelValue":e[0]||(e[0]=i=>s["system.app_name"]=i),placeholder:"请输入系统名称"},null,8,["modelValue"]),e[6]||(e[6]=l("div",{class:"text-xs text-gray-400 mt-1"},"显示在浏览器标题栏和登录页",-1))]),_:1}),o(_,{label:"系统 Logo"},{default:n(()=>[o(h,{modelValue:s["system.logo"],"onUpdate:modelValue":e[1]||(e[1]=i=>s["system.logo"]=i),placeholder:"上传 Logo","empty-text":"暂无Logo",tip:"建议尺寸 128x128，支持 png/jpg/svg"},null,8,["modelValue"])]),_:1}),o(_,{label:"浏览器图标 (Favicon)"},{default:n(()=>[o(h,{modelValue:s["system.favicon"],"onUpdate:modelValue":e[2]||(e[2]=i=>s["system.favicon"]=i),placeholder:"上传图标",accept:".ico","empty-text":"暂无图标",tip:"建议尺寸 32x32 或 16x16，仅支持 ico"},null,8,["modelValue"])]),_:1})]),l("div",se,[e[9]||(e[9]=l("h3",{class:"text-base font-medium mb-4 pb-2 border-b"},"安全设置",-1)),o(_,{label:"会话超时时间 (分钟)",required:""},{default:n(()=>[o(E,{modelValue:s["security.session_timeout"],"onUpdate:modelValue":e[3]||(e[3]=i=>s["security.session_timeout"]=i),min:5,max:1440},null,8,["modelValue"]),e[8]||(e[8]=l("div",{class:"text-xs text-gray-400 mt-1"},"用户登录后无操作自动退出的时间，默认 30 分钟",-1))]),_:1})])]),_:1})])),[[j,p.value]])]),_:1})])}}});export{le as default};
