import{d as D,r as _,am as V,N as P,b as x,o as u,f as i,e,w as n,t as o,h as s,$ as a,c as E,a6 as Y,E as $,g as v,_ as j,ap as I,J as T,G as B,a9 as C,ad as N}from"./index-tAfeRux5.js";import{u as L,g as O}from"./echarts-HKBR1yP9.js";const z={class:"p-4 space-y-4 bg-[#F0F2F5] min-h-screen text-[#333]"},U={class:"flex flex-wrap justify-between items-center gap-4"},G={class:"flex items-center gap-4"},H={class:"font-bold text-lg border-l-4 border-[#3B82F6] pl-3 text-gray-800"},q={class:"flex items-center gap-2"},J={class:"flex gap-2"},K={class:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4"},Q={class:"metric-card bg-gradient-to-r from-[#3B82F6] to-[#60A5FA]"},X={class:"card-content"},Z={class:"flex justify-between items-start"},ee={class:"flex flex-col"},te={class:"metric-label"},ae={class:"metric-value"},oe={key:0,class:"mt-4 flex items-center text-xs text-white/80"},se={class:"metric-card bg-gradient-to-r from-[#F97316] to-[#FB923C]"},re={class:"card-content"},le={class:"flex justify-between items-start"},ne={class:"flex flex-col"},de={class:"metric-label"},ie={class:"metric-value"},ce={key:0,class:"mt-4 flex items-center text-xs text-white/80"},he={class:"metric-card bg-gradient-to-r from-[#8B5CF6] to-[#A78BFA]"},pe={class:"card-content"},ue={class:"flex justify-between items-start"},me={class:"flex flex-col"},_e={class:"metric-label"},ge={class:"metric-value"},be={key:0,class:"mt-4 flex items-center text-xs text-white/80"},fe={class:"metric-card bg-gradient-to-r from-[#EF4444] to-[#F87171]"},xe={class:"card-content"},ve={class:"flex justify-between items-start"},we={class:"flex flex-col"},ye={class:"metric-label"},ke={class:"metric-value"},Be={class:"mt-4 flex items-center text-xs text-white/80"},Ce={class:"metric-card bg-gradient-to-r from-[#06B6D4] to-[#22D3EE]"},Se={class:"card-content"},Fe={class:"flex justify-between items-start"},Ee={class:"flex flex-col"},Le={class:"metric-label"},Re={class:"metric-value"},Ae={class:"mt-4 flex items-center text-xs text-white/80"},Me={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},We={class:"flex justify-between items-center"},De={class:"flex items-center gap-2"},Ve={class:"font-bold text-gray-800"},Pe={class:"text-xs text-gray-500"},Ye={class:"flex items-center gap-2"},$e={class:"font-bold text-gray-800"},je=D({name:"dashboard_workbench",__name:"index",setup(Ie){const d=_("year"),g=_(new Date().getFullYear().toString()),b=_(["2025-01","2025-12"]),l=_({total_income:0,income_growth:0,total_expense:0,expense_growth:0,new_customers:0,new_customers_growth:0,deal_customers:0,deal_customers_conversion_rate:0,total_profit:0,profit_margin:0}),f=_([]),R={人力成本:"labor",市场推广:"marketing",服务器资源:"cloud",办公用品:"office",差旅费:"travel",其他:"other",AI资源:"aiApi",软件订阅:"saas"};function A(c){const t=R[c];return t?a(`page.dashboard.workbench.expenseCategory.${t}`):c}async function w(){const c=b.value||[],{data:t}=await O({time_dimension:d.value,year:g.value,month_range:c.length===2?c:void 0});t&&(l.value=t.summary,S&&S(r=>(r.xAxis.data=t.trend_xAxis,r.series[0].data=t.trend_income,r.series[1].data=t.trend_expense,r.series[2].data=t.trend_profit,r.series[3].data=t.trend_margin,r)),f.value=t.expense_pie.map((r,p)=>({...r,name:A(r.name),itemStyle:{color:["#2dd4bf","#60a5fa","#818cf8","#fcd34d","#f472b6","#34d399"][p%6]}})),F&&F(r=>(r.series[0].data=f.value,r)))}V([d,g,b],()=>{w()}),P(()=>{w()});const{domRef:M,updateOptions:S}=L(()=>({tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"rgba(255, 255, 255, 0.95)",borderWidth:0,textStyle:{color:"#333"},shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.1)"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},legend:{data:[a("page.dashboard.workbench.totalIncome"),a("page.dashboard.workbench.totalExpense"),a("page.dashboard.workbench.totalProfit"),a("page.dashboard.workbench.profitMargin")],top:0,itemWidth:10,itemHeight:10,textStyle:{color:"#666"}},xAxis:{type:"category",data:[],axisLine:{lineStyle:{color:"#E5E7EB"}},axisLabel:{color:"#6B7280"}},yAxis:[{type:"value",name:a("page.dashboard.workbench.amountUnit"),nameTextStyle:{color:"#6B7280"},axisLabel:{color:"#6B7280"},splitLine:{lineStyle:{type:"dashed",color:"#F3F4F6"}}},{type:"value",name:a("page.dashboard.workbench.profitMargin"),nameTextStyle:{color:"#6B7280"},axisLabel:{color:"#6B7280",formatter:"{value} %"},splitLine:{show:!1}}],series:[{name:a("page.dashboard.workbench.totalIncome"),type:"bar",barWidth:"20%",itemStyle:{borderRadius:[4,4,0,0],color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#2dd4bf"},{offset:1,color:"rgba(45, 212, 191, 0.2)"}]}},data:[]},{name:a("page.dashboard.workbench.totalExpense"),type:"bar",barWidth:"20%",itemStyle:{borderRadius:[4,4,0,0],color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#818cf8"},{offset:1,color:"rgba(129, 140, 248, 0.2)"}]}},data:[]},{name:a("page.dashboard.workbench.totalProfit"),type:"bar",barWidth:"20%",itemStyle:{borderRadius:[4,4,0,0],color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#60a5fa"},{offset:1,color:"rgba(96, 165, 250, 0.2)"}]}},data:[]},{name:a("page.dashboard.workbench.profitMargin"),type:"line",yAxisIndex:1,smooth:!0,symbol:"circle",symbolSize:8,lineStyle:{width:3,color:"#fcd34d"},itemStyle:{color:"#fcd34d",borderColor:"#fff",borderWidth:2},data:[]}]})),{domRef:W,updateOptions:F}=L(()=>({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{bottom:"0%",left:"center",itemWidth:10,itemHeight:10,textStyle:{color:"#666"},formatter:c=>{const t=f.value.find(h=>h.name===c),r=f.value.reduce((h,y)=>h+y.value,0),p=t&&r>0?(t.value/r*100).toFixed(1)+"%":"0%";return`${c}  ${p}`}},series:[{name:a("page.dashboard.workbench.expenditureComposition"),type:"pie",radius:["45%","70%"],center:["50%","50%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:8,borderColor:"#fff",borderWidth:3},label:{show:!1},data:[]}]}));return(c,t)=>{const r=Y,p=j,h=$,y=I,k=T;return u(),x("div",z,[i(k,{shadow:"never",class:"!border-none !bg-white rounded-lg shadow-sm","body-style":{padding:"16px"}},{default:n(()=>[e("div",U,[e("div",G,[e("div",H,o(s(a)("page.dashboard.workbench.overview")),1),e("div",q,[d.value==="year"?(u(),E(r,{key:0,modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=m=>g.value=m),type:"year",placeholder:s(a)("page.dashboard.workbench.year"),size:"default",style:{width:"100px"},"value-format":"YYYY",clearable:!1},null,8,["modelValue","placeholder"])):(u(),E(r,{key:1,modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=m=>b.value=m),type:"monthrange","range-separator":"-","start-placeholder":s(a)("page.dashboard.workbench.start"),"end-placeholder":s(a)("page.dashboard.workbench.end"),size:"default",style:{width:"200px"},"value-format":"YYYY-MM",clearable:!1},null,8,["modelValue","start-placeholder","end-placeholder"])),e("div",J,[i(h,{type:"primary",class:"!bg-[#3B82F6] !border-[#3B82F6] hover:!bg-[#2563EB]",onClick:w},{icon:n(()=>[i(p,{icon:"mdi:magnify",class:"text-lg"})]),default:n(()=>[v(" "+o(s(a)("page.dashboard.workbench.query")),1)]),_:1}),i(h,{class:"!text-[#666] hover:!text-[#3B82F6] hover:!border-[#3B82F6]"},{icon:n(()=>[i(p,{icon:"mdi:refresh",class:"text-lg"})]),default:n(()=>[v(" "+o(s(a)("page.dashboard.workbench.reset")),1)]),_:1})])])]),i(y,null,{default:n(()=>[i(h,{type:d.value==="month"?"primary":"default",onClick:t[2]||(t[2]=m=>d.value="month"),class:"!h-8"},{default:n(()=>[v(o(s(a)("page.dashboard.workbench.month")),1)]),_:1},8,["type"]),i(h,{type:d.value==="year"?"primary":"default",onClick:t[3]||(t[3]=m=>d.value="year"),class:"!h-8"},{default:n(()=>[v(o(s(a)("page.dashboard.workbench.yearLabel")),1)]),_:1},8,["type"])]),_:1})])]),_:1}),e("div",K,[e("div",Q,[e("div",X,[e("div",Z,[e("div",ee,[e("span",te,o(s(a)("page.dashboard.workbench.totalIncome")),1),e("span",ae,o(Math.round(l.value.total_income).toLocaleString()),1)]),t[4]||(t[4]=e("div",{class:"i-mdi-currency-usd text-3xl text-white/30 p-2 bg-white/10 rounded-lg"},null,-1))]),d.value==="year"?(u(),x("div",oe,[e("span",null,o(s(a)("page.dashboard.workbench.comparePrevious"))+" "+o(l.value.income_growth>=0?"+":"")+o(l.value.income_growth)+"%",1),e("div",{class:C([l.value.income_growth>=0?"i-mdi-trending-up":"i-mdi-trending-down","ml-1"])},null,2)])):B("",!0)])]),e("div",se,[e("div",re,[e("div",le,[e("div",ne,[e("span",de,o(s(a)("page.dashboard.workbench.totalExpense")),1),e("span",ie,o(Math.round(l.value.total_expense).toLocaleString()),1)]),t[5]||(t[5]=e("div",{class:"i-mdi-cash-minus text-3xl text-white/30 p-2 bg-white/10 rounded-lg"},null,-1))]),d.value==="year"?(u(),x("div",ce,[e("span",null,o(s(a)("page.dashboard.workbench.comparePrevious"))+" "+o(l.value.expense_growth>=0?"+":"")+o(l.value.expense_growth)+"%",1),e("div",{class:C([l.value.expense_growth>=0?"i-mdi-trending-up":"i-mdi-trending-down","ml-1"])},null,2)])):B("",!0)])]),e("div",he,[e("div",pe,[e("div",ue,[e("div",me,[e("span",_e,o(s(a)("page.dashboard.workbench.newCustomers")),1),e("span",ge,o(l.value.new_customers),1)]),t[6]||(t[6]=e("div",{class:"i-mdi-account-plus text-3xl text-white/30 p-2 bg-white/10 rounded-lg"},null,-1))]),d.value==="year"?(u(),x("div",be,[e("span",null,o(s(a)("page.dashboard.workbench.comparePrevious"))+" "+o(l.value.new_customers_growth>=0?"+":"")+o(l.value.new_customers_growth)+"%",1),e("div",{class:C([l.value.new_customers_growth>=0?"i-mdi-trending-up":"i-mdi-trending-down","ml-1"])},null,2)])):B("",!0)])]),e("div",fe,[e("div",xe,[e("div",ve,[e("div",we,[e("span",ye,o(s(a)("page.dashboard.workbench.dealCustomers")),1),e("span",ke,o(l.value.deal_customers),1)]),t[7]||(t[7]=e("div",{class:"i-mdi-handshake text-3xl text-white/30 p-2 bg-white/10 rounded-lg"},null,-1))]),e("div",Be,[e("span",null,o(s(a)("page.dashboard.workbench.conversionRate"))+" "+o(l.value.deal_customers_conversion_rate)+"%",1)])])]),e("div",Ce,[e("div",Se,[e("div",Fe,[e("div",Ee,[e("span",Le,o(s(a)("page.dashboard.workbench.totalProfit")),1),e("span",Re,o(Math.round(l.value.total_profit).toLocaleString()),1)]),t[8]||(t[8]=e("div",{class:"i-mdi-chart-line text-3xl text-white/30 p-2 bg-white/10 rounded-lg"},null,-1))]),e("div",Ae,[e("span",null,o(s(a)("page.dashboard.workbench.profitMargin"))+" "+o(l.value.profit_margin)+"%",1)])])])]),e("div",Me,[i(k,{class:"lg:col-span-2 !border-none shadow-sm rounded-lg","body-style":{padding:"20px"}},{header:n(()=>[e("div",We,[e("div",De,[t[9]||(t[9]=e("div",{class:"w-1 h-4 bg-[#3B82F6] rounded-sm"},null,-1)),e("span",Ve,o(s(a)("page.dashboard.workbench.trendTitle")),1)]),e("span",Pe,o(s(a)("page.dashboard.workbench.trendDesc")),1)])]),default:n(()=>[e("div",{ref_key:"trendChartRef",ref:M,class:"w-full h-[380px]"},null,512)]),_:1}),i(k,{class:"shadow-sm rounded-lg","body-style":{padding:"20px"}},{header:n(()=>[e("div",Ye,[t[10]||(t[10]=e("div",{class:"w-1 h-4 bg-[#10B981] rounded-sm"},null,-1)),e("span",$e,o(s(a)("page.dashboard.workbench.expenditureComposition")),1)])]),default:n(()=>[e("div",{ref_key:"expenseChartRef",ref:W,class:"w-full h-[380px]"},null,512)]),_:1})])])}}}),Oe=N(je,[["__scopeId","data-v-01a8e054"]]);export{Oe as default};
